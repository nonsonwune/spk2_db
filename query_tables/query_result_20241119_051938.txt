Query: what region applied for the engineering courses the most

Generated SQL Query:


		WITH YearlyStats AS (
			SELECT 
				c.year,
				COUNT(DISTINCT c.regnumber) as total_candidates,
				COUNT(DISTINCT CASE WHEN c.is_admitted = true THEN c.regnumber END) as admitted_count,
				COUNT(DISTINCT CASE WHEN c.gender = 'M' THEN c.regnumber END) as male_count,
				COUNT(DISTINCT CASE WHEN c.gender = 'F' THEN c.regnumber END) as female_count,
				COUNT(DISTINCT CASE WHEN c.is_direct_entry = true THEN c.regnumber END) as direct_entry_count,
				ROUND(AVG(c.aggregate)::numeric, 2) as average_score,
				COUNT(DISTINCT c.app_course1) as unique_courses,
				COUNT(DISTINCT c.inid) as unique_institutions,
				COUNT(DISTINCT f.fac_id) as unique_faculties,
				COUNT(DISTINCT CASE WHEN c.is_mock_candidate = true THEN c.regnumber END) as mock_candidates,
				ROUND(AVG(EXTRACT(YEAR FROM age(c.date_of_birth)))::numeric, 2) as avg_age
			FROM candidate c
			JOIN course co ON c.app_course1 = co.course_code
			JOIN faculty f ON co.facid = f.fac_id
			WHERE c.year = 2023
			GROUP BY c.year
		)
		SELECT 
			*,
			ROUND((admitted_count::float * 100 / NULLIF(total_candidates, 0))::numeric, 2) as admission_rate,
			ROUND((male_count::float * 100 / NULLIF(total_candidates, 0))::numeric, 2) as male_percentage,
			ROUND((female_count::float * 100 / NULLIF(total_candidates, 0))::numeric, 2) as female_percentage
		FROM YearlyStats
		ORDER BY year DESC;
	

Results Table:
--------------

year  | total_candidates  | admitted_count  | male_count  | female_count  | direct_entry_count  | average_score     | unique_courses  | unique_institutions  | unique_faculties  | mock_candidates  | avg_age           | admission_rate  | male_percentage   | female_percentage  
------+-------------------+-----------------+-------------+---------------+---------------------+-------------------+-----------------+----------------------+-------------------+------------------+-------------------+-----------------+-------------------+--------------------
2023  | 1463103           | 0               | 745555      | 717548        | 0                   | [50 49 46 51 48]  | 11659           | 771                  | 16                | 0                | [50 48 46 50 48]  | [48 46 48 48]   | [53 48 46 57 54]  | [52 57 46 48 52]   

Table Description: Query results showing requested JAMB candidate information
